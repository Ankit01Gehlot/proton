SELECT  C_CITY,  S_CITY,  to_year(LO_ORDERDATE) AS year,  sum(LO_REVENUE) AS revenue FROM table(lineorder_flat) WHERE (C_CITY = 'UNITED KI1' OR C_CITY = 'UNITED KI5') AND (S_CITY = 'UNITED KI1' OR S_CITY = 'UNITED KI5') AND to_YYYYMM(LO_ORDERDATE) = 199712 GROUP BY  C_CITY,  S_CITY,  year ORDER BY  year ASC,  revenue DESC