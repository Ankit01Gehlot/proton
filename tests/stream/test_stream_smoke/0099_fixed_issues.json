{
  "test_suite_name": "fixed_issues",
  "tag": "smoke",

  "test_suite_config":{
    "tests_2_run": {"ids_2_run": ["all"], "tags_2_run":[], "tags_2_skip":{"default":["todo", "to_support", "change", "bug", "sample"],"cluster": ["view", "cluster_table_bug"]}}
  },
  "comments": "Tests covering fixed issues smoke cases.",
  "tests": [
    {
      "id": 0,
      "tags": ["materialized view"],
      "name": "#1288",
      "description": "create materialized view over materialized view with last emit",
      "steps":[
        {
          "statements": [
            {"client":"python", "query_type": "table", "wait":2, "query":"drop view if exists mv_2"},
            {"client":"python", "query_type": "table", "wait":2, "query":"drop view if exists mv_1"},
            {"client":"python", "query_type": "table", "wait":2, "query":"drop view if exists mv_truck_track"},
            {"client":"python", "query_type": "table", "wait":2, "query":"drop stream if exists ttp_truck_track"},
            {"client":"python", "query_type": "table", "wait":2, "query_id":"9900", "query": "create stream ttp_truck_track(`lpn` string, `vno` string, `drc` string, `drcCode` int32, `wgs84Lat` float32, `wgs84Lon` float32, `gcj02Lat` float32, `gcj02Lon` float32, `province` nullable(string), `city` nullable(string), `country` nullable(string), `spd` float32, `mil` float32, `time` string, `adr` string)"},
            {"client":"python", "query_type": "table", "wait":5, "query_id":"9901", "query": "create materialized view default.mv_truck_track as (select * from default.ttp_truck_track where date_diff('second', _tp_time, now()) < 30)"},
            {"client":"python", "query_type": "table", "wait":5, "query_id":"9902", "query": "create materialized view if not exists mv_1 as (select now() as time, count_distinct(lpn) as cnt from mv_truck_track emit last 10m and periodic 10s)"},
            {"client":"python", "query_type": "table", "wait":5, "query_id":"9903", "query": "create materialized view if not exists mv_2 as (select now() as time, count_distinct(lpn) as cnt from default.mv_truck_track emit last 10m and periodic 10s)"}
          ]
        }
      ],
      "expected_results": [
        {"query_id":"9900", "expected_results":[]},
        {"query_id":"9901", "expected_results":[]},
        {"query_id":"9902", "expected_results":[]},
        {"query_id":"9903", "expected_results":[]}
      ]
    }
  ]
}