{
    "test_suite_name": "smoke",
    "commments":
        "Tests covering the steam query smoke cases.",
    "test_suite_config": {
        "table_schemas":[
            {
                "name": "test",
                "type": "table",
                "columns": [
                    {
                        "name": "id",
                        "type": "string"
                    },
                    {
                        "name": "location",
                        "type": "string"
                    },
                    {
                        "name": "value",
                        "type": "float32"
                    },
                    {
                        "name": "json",
                        "type": "string"

                    },
                    {
                        "name": "timestamp",
                        "type": "datetime64(3)",
                        "default": "now64(3)"
                    }
                ],
                "event_time_column":"timestamp"
            },
            {
                "name": "test_no_default_tp_time",
                "type": "table",
                "columns": [
                    {
                        "name": "id",
                        "type": "string"
                    },
                    {
                        "name": "location",
                        "type": "string"
                    },
                    {
                        "name": "value",
                        "type": "float32"
                    },
                    {
                        "name": "json",
                        "type": "string"

                    },
                    {
                        "name": "timestamp",
                        "type": "Datetime64(3)",
                        "default": "now64(3)"
                    }
                ]
            },
            {
                "name": "test_seek",
                "type": "table",
                "columns": [
                    {
                        "name": "id",
                        "type": "string"
                    },
                    {
                        "name": "location",
                        "type": "string"
                    },
                    {
                        "name": "value",
                        "type": "float32"
                    },
                    {
                        "name": "json",
                        "type": "string"

                    },
                    {
                        "name": "timestamp",
                        "type": "datetime64(3)",
                        "default": "now64(3)"
                    }
                ],
                "event_time_column":"timestamp"
            },
            {
                "name": "test_d",
                "type": "table",
                "columns": [
                    {
                        "name": "id",
                        "type": "string"
                    },
                    {
                        "name": "type",
                        "type": "string"
                    }

                ]},
                {
                    "name": "test_v",
                    "type": "view",
                    "create_sql": "create view if not exists test_v as select * from test",
                    "drop_sql": "drop view test_v"
                },
                {
                    "name": "test_join_v",
                    "type": "view",
                    "create_sql": "create view if not exists test_join_v as select a.id, b.type, a.value, a.json, a.timestamp, to_datetime(json_extract_string(json, 'create_time')) as transformed_timestamp, _tp_time, _tp_index_time from test as a join table(test_d) as b on a.id =b.id",
                    "drop_sql": "drop view test_join_v"
                }

        ],
        "setup": {
            "inputs": [
                {"table_name":"test_d", "data": [
                ["dev1", "roof"],
                ["dev2", "field"],
                ["dev3", "window"],
                ["dev4", "wall"],
                ["dev5", "roof"],
                ["dev6", "window"],
                ["dev7", "wall"],
                ["dev8", "floor"]]
                }
            ]
        },
        "tests_2_run": {"ids_2_run": ["all"], "tags_2_run":[], "tags_2_skip":{"default":["todo", "to_support", "change", "bug", "sample", "native_not_support"], "cluster": ["view", "materialized view"]}}
    },

    "tests": [
        {
            "id": 0,
            "tags": ["tumble window"],
            "name": "stream tumble window max(value) aggregate group by id, window_start, window_end",
            "description": "tumble window aggregate by max and group by id, window_start, window_end",
            "steps":[
                {"statements": [
                    {"client":"python", "query_id": 101, "depends_on_stream":"test", "run_mode":"process", "query_type": "stream", "terminate":"manuel", "query_end_timer": 1, "query":"select id, max(value), window_start, window_end from tumble(test, timestamp, interval 5 second) group by id, window_start, window_end emit stream"},
                    {"client":"python", "query_id": 102, "depends_on_stream":"test", "run_mode":"process", "query_type": "stream", "terminate":"auto","query_end_timer": 1, "query":"select id, max(value), window_start, window_end from tumble(test, timestamp, interval 5 second) group by id, window_start, window_end emit stream"}
                ]},


                {"inputs": [
                    {"table_name": "test", "depends_on":"102", "wait":3, "data": [
                        ["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:00"],
                        ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:03"]
                    ]},
                    {"table_name": "test", "data": [["dev6", "ca", 66, "\"create_time\":\"2021-11-02 20:00:11\"", "2020-02-02 20:00:04"]]}
                    ,
                    {"table_name": "test", "data": [["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:11\"", "2020-02-02 20:00:10"]]}
                ]},

                {"statements": [
                    {"client":"python", "wait": 4, "run_mode":"process", "query_type": "batch", "query":"kill query where query_id = '101'"},
                    {"client":"python", "query_type": "table", "query":"select id, max(value) from table(test) group by id, location"}
                ]
                }

            ],

            "expected_results": [
                {"query_id": "101",
                    "expected_results":
                    [["dev2", "58.3", "2020-02-02 20:00:00", "2020-02-02 20:00:05"],
                    ["dev6", "66.0", "2020-02-02 20:00:00", "2020-02-02 20:00:05"],
                    ["dev1", "57.3", "2020-02-02 20:00:00", "2020-02-02 20:00:05"]]
                },
                {"query_id": "102",
                    "expected_results":
                    [["dev2", "58.3", "2020-02-02 20:00:00", "2020-02-02 20:00:05"],
                    ["dev6", "66.0", "2020-02-02 20:00:00", "2020-02-02 20:00:05"],
                    ["dev1", "57.3", "2020-02-02 20:00:00", "2020-02-02 20:00:05"]]
                }

            ]
        },
        {
            "id": 1,
            "tags": ["syntax exception"],
            "name": "stream query expected exception: not under aggregate and not in group",
            "description": "expected exception",
            "steps":[
                {"statements": [
                        {"client":"python", "query_id": 101, "query_type": "stream", "terminate":"auto", "query":"select id, max(value), window_start, window_end from tumble(test, timestamp, interval 5 second) group by window_start, window_end emit stream"}
                ]

                }
            ],
            "expected_results": [{"query_id": 101, "expected_results": "error_code:215"}]
        },
        {
            "id": 2,
            "tags": ["syntax exception", "bug"],
            "name": "stream query expected exception: global stream query w/ PERIODIC INTERVAL but no aggreagation",
            "description": "expected exception",
            "steps": [
                {"statements": [
                    {"client":"python", "query_id": 101, "query_type": "stream", "terminate":"auto", "query":"SELECT * FROM test WHERE value >25 EMIT STREAM PERIODIC INTERVAL 2 SECOND"}
                ]}
            ],

            "expected_results": [{"query_id": 101, "expected_results": "error_code:62"}]
        },
        {
            "id": 3,
            "tags": ["syntax exception"],
            "name": "stream query expected exception: stream query group by w/ both window_start and window_end lacked",
            "description": "expected exception",
            "steps":[
                {"statements": [
                    {"client":"python", "query_id": 101, "query_type": "stream", "terminate":"auto", "query":"select id, max(value) from tumble(test, timestamp, interval 5 second) group by id emit stream after watermark"}
                ]}
            ],

            "expected_results": [{"query_id": 101, "expected_results":"error_code:2002"}]
        },
        {
            "id": 4,
            "tags": ["tumble window"],
            "name": "stream tumble window with designated timestamp w/ out of order timestamp within window.",
            "description": "stream tumble window with designated 5 sec timestamp.",
            "steps":[
                {"statements": [
                    {"client":"python", "query_id": 101, "query_type": "stream", "terminate":"auto", "query_end_timer": 3, "query":"select max(value), window_start, window_end from tumble(test, timestamp, interval 5 second) group by window_start, window_end emit stream"}
                ]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101", "wait":1, "data": [
                        ["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:14"],
                        ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:13"]
                    ]},

                    {"table_name":"test", "data": [["dev6", "ca", 66, "\"create_time\":\"2021-11-02 20:00:11\"", "2020-02-02 20:00:12"]]}
                    ,
                    {"table_name":"test", "data": [["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:11\"", "2020-02-02 20:00:15"]]}
                ]
                }
            ],
            "expected_results": [{"query_id" : 101, "expected_results":
                [["66", "2020-02-02 20:00:10", "2020-02-02 20:00:15"]]}
            ]
        },
        {
            "id": 5,
            "tags": ["tumble window"],
            "name": "stream tumble window w/ 1st batch inputs data cross multiple windows - #104",
            "description": "stream tumble window query and send 3 inptus in the first batch, the window_start of the next window should be based on the minimal timestamp of the first batch",
            "steps": [
                {"statements": [
                    {"client":"python", "query_id": 101, "query_type": "stream","query_end_timer": 1, "query":"select window_start, window_end, max(timestamp), min(timestamp) from tumble(test, timestamp, interval 3 second) where value > 50 group by  window_start, window_end emit stream"}]},
                {"inputs": [
                        {"table_name":"test", "wait":1, "depends_on":"101","data": [
                            ["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:20"],
                            ["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:23"],
                            ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:27"]
                        ]}
                ]}
            ],

            "expected_results": [ {"query_id": 101, "expected_results":
                [
                    ["2020-02-02 20:00:18", "2020-02-02 20:00:21", "2020-02-02 20:00:20", "2020-02-02 20:00:20"],
                    ["2020-02-02 20:00:21", "2020-02-02 20:00:24", "2020-02-02 20:00:23", "2020-02-02 20:00:23"]
                ]}
            ]
        },
        {
            "id": 6,
            "tags": ["tumble window"],
            "name": "stream query w/ inputs with timestamp early than latest timestamp in stream table",
            "description": "stream query aggregate by max is created and then ingest data w/ timestamp early than latest timestamp in stream table, projection based on the inputs should be emitted. ",
            "steps":[
                {"statements": [
                    {"client":"python", "query_id": "101", "query_type": "stream", "query_end_timer": 1,"query":"select id, max(value), window_start, window_end from tumble(test, timestamp, interval 5 second) group by id, window_start, window_end emit stream"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1, "data":[
                        ["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:00"],
                        ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:03"]
                    ]},

                    {"table_name":"test", "data":[["dev6", "ca", 66, "\"create_time\":\"2021-11-02 20:00:11\"", "2020-02-02 20:00:04"]]}
                    ,
                    {"table_name":"test", "data": [["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:11\"", "2020-02-02 20:00:05"]]},
                    {"table_name":"test", "data":[["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:11\"", "2020-02-02 20:00:30"]]}
                ]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev2", "58.3", "2020-02-02 20:00:00", "2020-02-02 20:00:05"],
                    ["dev6", "66.0", "2020-02-02 20:00:00", "2020-02-02 20:00:05"],
                    ["dev1", "57.3", "2020-02-02 20:00:00", "2020-02-02 20:00:05"],
                    ["dev8", "67", "2020-02-02 20:00:05", "2020-02-02 20:00:10"]]}]
        },

        {
            "id": 7,
            "tags": ["tumble window", "delay"],
            "name": "stream tumble late events drop w/ window delay interval  - #107",
            "description": "an example positive test that uses insert into w/o column",
            "steps": [
                {"statements": [
                    {"client":"python", "query_id":"101" ,"query_type": "stream", "query_end_timer": 1,"query":"select window_start, window_end, count(*) from tumble(test, timestamp, interval 5 second) group by  window_start, window_end, value emit stream after watermark and delay interval 2 second"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1,"data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:30"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:31"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:32"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 59.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:50"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:34"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:37"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:45"]]}
                ]}
            ]
            ,
            "expected_results": [{"query_id":"101", "expected_results":
                [["2020-02-02 20:00:30", "2020-02-02 20:00:35", 3]]}
            ]
        },
        {
            "id": 8,
            "tags": ["tumble window"],
            "name": "stream tumble w/inputs across multiple windows for window start alignment, with emit_version() - #101",
            "description": "stream tumble w/inputs across multiple windows for window start alignment and the last input in the middle of latest window - #101",
            "steps":[
                {"statements": [
                    {"client":"python", "query_id":"101", "query_type": "stream", "query_end_timer": 3,"query":"select emit_version() as emit_version, window_start, window_end, count(*) from tumble(test, timestamp, interval 3 second) where value > 50 group by  window_start, window_end emit stream"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1,"data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:50"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:51"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:55"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:57"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                [["0", "2020-02-02 20:00:48", "2020-02-02 20:00:51", 1],
                ["1", "2020-02-02 20:00:51", "2020-02-02 20:00:54", 1],
                ["2", "2020-02-02 20:00:54", "2020-02-02 20:00:57", 1]]}
            ]
        },
        {
            "id": 9,
            "tags": ["tumble window", "delay"],
            "name": "stream query tumble window w/delay: no aggregation to be emit before delay gate",
            "description": "steram query with 5sec window and delay 3 sec w/late events within 2 sec delay",
            "steps": [
                {"statements": [
                    {"client":"python", "query_id":"101", "query_type": "stream", "query_end_timer": 1,"query":"select window_start, window_end, count(*) from tumble(test, timestamp, interval 5 second) group by  window_start, window_end, value emit stream after watermark and delay interval 3 second"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:07"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101","expected_results":[]}
            ]
        },
        {
            "id": 10,
            "tags": ["tumble window", "delay"],
            "name": "stream query tumble window w/delay: no aggregation to be emit when delay gate",
            "description": "steram query with 5sec window and delay 3 sec w/late events within 2 sec delay",
            "steps":[
                {"statements": [
                    {"client":"python", "query_id":"101", "query_type": "stream", "query_end_timer": 1,"query":"select window_start, window_end, count(*) from tumble(test, timestamp, interval 5 second) group by  window_start, window_end, value emit stream after watermark and delay interval 3 second"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1,"data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]}
                    ]}

            ],

            "expected_results": [{"query_id":"101", "expected_results": [["2020-02-02 20:01:00", "2020-02-02 20:01:05", 4]]}

            ]
        },
        {
            "id": 11,
            "tags": ["hopping window"],
            "name": "stream hopping window max(value) aggregate group by id, window_start, window_end, with emit_version()",
            "description": "tumble window aggregate by max and group by id, window_start, window_end",
            "steps": [
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer": 1,"query":"select emit_version(), id, max(value), window_start, window_end from hop(test, timestamp, interval 3 second, interval 5 second) group by id, window_start, window_end emit stream"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [
                        ["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:00"],
                        ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:03"]
                    ]},

                    {"table_name":"test", "data": [["dev6", "ca", 66, "\"create_time\":\"2021-11-02 20:00:11\"", "2020-02-02 20:00:04"],
                        ["dev6", "ca", 69, "\"create_time\":\"2021-11-02 20:00:11\"", "2020-02-02 20:00:05"]]}
                    ,
                    {"table_name":"test", "data": [["dev8", "ca", 68, "\"create_time\":\"2021-11-02 20:00:11\"", "2020-02-02 20:00:08"],
                        ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:11\"", "2020-02-02 20:00:10"]
                    ]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":[["0", "dev1", "57.3", "2020-02-02 19:59:57", "2020-02-02 20:00:02"],
                ["1", "dev2", "58.3", "2020-02-02 20:00:00", "2020-02-02 20:00:05"],
                ["1", "dev6", "66", "2020-02-02 20:00:00", "2020-02-02 20:00:05"],
                ["1", "dev1", "57.3", "2020-02-02 20:00:00", "2020-02-02 20:00:05"],
                ["2", "dev6", "69", "2020-02-02 20:00:03", "2020-02-02 20:00:08"],
                ["2", "dev2", "58.3", "2020-02-02 20:00:03", "2020-02-02 20:00:08"]]}
                ]
        },

        {
            "id": 12,
            "tags": ["hopping window", "to verify"],
            "name": "hopping window w/1st data not alinged with window start",
            "description": "tranform function in subquery to extract timestamp from a json and run hopping on the subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), window_start, window_end from hop(test, timestamp, interval 2 second, interval 5 second) group by id, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev1", 60, "2021-11-02 19:59:58", "2021-11-02 20:00:03"],
                    ["dev2", 58.3, "2021-11-02 19:59:58", "2021-11-02 20:00:03"],
                    ["dev2", 66, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                    ["dev1", 60, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                    ["dev1", 59, "2021-11-02 20:00:02", "2021-11-02 20:00:07"],
                    ["dev2", 66, "2021-11-02 20:00:02", "2021-11-02 20:00:07"],
                    ["dev8", 77, "2021-11-02 20:00:02", "2021-11-02 20:00:07"],
                    ["dev1", 59, "2021-11-02 20:00:04", "2021-11-02 20:00:09"],
                    ["dev8", 77, "2021-11-02 20:00:04", "2021-11-02 20:00:09"],
                    ["dev3", 66, "2021-11-02 20:00:04", "2021-11-02 20:00:09"],
                    ["dev4", 76, "2021-11-02 20:00:04", "2021-11-02 20:00:09"]
                    ]}]
        },

        {
            "id": 13,
            "tags": ["hopping window w/ slide interal > window interval"],
            "name": "stream hopping window max(value) aggregate group by id, window_start, window_end, slide interval > window interval",
            "description": "tumble window aggregate by max and group by id, window_start, window_end",
            "steps":[
                {"statements": [
                    {"client":"python", "query_id":"101", "query_type": "stream","query_end_timer": 1, "query":"select id, max(value), window_start, window_end from hop(test, timestamp, interval 5 second, interval 3 second) group by id, window_start, window_end emit stream"}]},
                {"inputs": [
                    {"table_name":"test","wait":1, "data": [
                        ["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:00"],
                        ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:03"]
                    ]},

                    {"table_name":"test", "data": [["dev6", "ca", 66, "\"create_time\":\"2021-11-02 20:00:11\"", "2020-02-02 20:00:04"],
                        ["dev6", "ca", 69, "\"create_time\":\"2021-11-02 20:00:11\"", "2020-02-02 20:00:05"]]}
                    ,
                    {"table_name":"test", "data": [["dev8", "ca", 68, "\"create_time\":\"2021-11-02 20:00:11\"", "2020-02-02 20:00:08"],
                        ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:11\"", "2020-02-02 20:00:10"]
                    ]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":"error_code:36"}]
        },
        {
            "id": 14,
            "tags": ["hopping window", "delay"],
            "name": "stream hopping window count(*) w/delay",
            "description": "tumble window aggregate by max and group by id, window_start, window_end",
            "steps":[
                {"statements": [
                    {"client":"python", "query_id":"101", "query_type": "stream","query_end_timer": 1, "query":"select location, count(*), window_start, window_end from hop(test, timestamp, interval 3 second, interval 5 second) group by location, window_start, window_end emit stream after watermark and delay interval 2 second"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 51, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:00"],
                    ["dev1", "ca", 99, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:02"],
                    ["dev1", "ca", 87, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:01"],
                    ["dev2", "ca", 66, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:03"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 33, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:07"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 46, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:06"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 98, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:05"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 101, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:08"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 101, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:07"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 56, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:10"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 22, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:11"],
                    ["dev1", "ca", 51, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:00:14"],
                    ["dev2", "ca", 62, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:11"],
                    ["dev2", "ca", 47, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:00:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["ca", "2", "2020-02-02 19:59:57", "2020-02-02 20:00:02"],
                    ["ca", "4", "2020-02-02 20:00:00", "2020-02-02 20:00:05"],
                    ["ca", "5", "2020-02-02 20:00:03", "2020-02-02 20:00:08"],
                    ["ca", "5", "2020-02-02 20:00:06", "2020-02-02 20:00:11"]]}]
        },
        {
            "id": 15,
            "tags": ["global"],
            "name": "global aggregation by max and group by id w/by default periodic",
            "description": "global aggregation by max and group by id, execute query, end query after 5 second",
            "steps":[
                {"statements": [
                    {"client":"python", "query_id":"101", "query_type": "stream", "query_end_timer":6, "query":"select id, max(value) from test group by id limit 4 emit periodic 5s"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101", "wait":1,"data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev3", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]}
                ]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":[["dev2", "80"],
                ["dev8", "77"],
                ["dev1", "66"],
                ["dev3", "66"]]}
            ]
        },

        {
            "id": 16,
            "tags": ["global"],
            "name": "global sum distinct",
            "description": "global aggregation sum distinct and group by id, execute query, end query after 5 second",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":6, "query":"select id, sum(distinct value), count(distinct value) from test group by id limit 4 emit periodic 5s"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1,"data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev3", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]}
                ]}

            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev2", "273.3", "4"],
                ["dev8", "144", "2"],
                ["dev1", "123.3", "2"],
                ["dev3", "123.3", "2"]]
            }]

        },

        {
            "id": 17,
            "tags": ["last x", "native_not_support"],
            "name": "last x global aggregation w/where",
            "description": "last 5s global aggregation count *",
            "steps":[

                {"inputs": [
                    {"table_name":"test_no_default_tp_time", "wait":3, "data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"],
                    ["dev2", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"],
                    ["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev3", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"],
                    ["dev2", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]
                    ]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"101", "wait":1, "query_type": "stream", "query_end_timer":6, "query":"select count(*) from test_no_default_tp_time where value >60 limit 5 emit last 5s"}]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["8"],
                    ["8"],
                    ["8"],
                    ["8"],
                    ["8"]
                    ]}]
        },
        {
            "id": 18,
            "tags": ["last x", "native_not_support"],
            "name": "last x tumble delay",
            "description": "max(value) tumble 5s and delay 2s group by id, window_start, window_end and last 1m",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), window_start, window_end from tumble(test_no_default_tp_time, timestamp, 5s) group by id, window_start, window_end limit 6 emit after watermark and delay 2s and last 6s"}]},
                {"inputs": [
                    {"table_name":"test_no_default_tp_time", "depends_on":"101", "wait":1,"data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test_no_default_tp_time", "data": [["dev3", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]},
                    {"table_name":"test_no_default_tp_time", "data": [["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:09"],
                    ["dev3", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:10"],
                    ["dev2", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:09"]]},
                    {"table_name":"test_no_default_tp_time", "data": [["dev2", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:11"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:12"]]}
                ]}
            ]
,
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev1", "66", "2020-02-02 20:01:00", "2020-02-02 20:01:05"],
                    ["dev8", "67", "2020-02-02 20:01:00", "2020-02-02 20:01:05"],
                    ["dev3", "59", "2020-02-02 20:01:00", "2020-02-02 20:01:05"],
                    ["dev8", "77", "2020-02-02 20:01:05", "2020-02-02 20:01:10"],
                    ["dev3", "57.3", "2020-02-02 20:01:05", "2020-02-02 20:01:10"],
                    ["dev2", "80", "2020-02-02 20:01:05", "2020-02-02 20:01:10"]
                    ]}]
        },

        {
            "id": 19,
            "tags": ["last x", "native_not_support"],
            "name": "last x tumble delay with distinct",
            "description": "last 20s tumble 5s count(*)",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":8, "query":"select id, sum(distinct value), window_end from tumble(test_no_default_tp_time, timestamp, 5s) group by id, window_end emit after watermark and delay 2s and last 1s"}]},
                {"inputs": [
                    {"table_name":"test_no_default_tp_time","depends_on":"101","wait":1, "data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test_no_default_tp_time", "data": [["dev3", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]},
                    {"table_name":"test_no_default_tp_time", "data": [["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:09"],
                    ["dev3", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:10"],
                    ["dev2", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:09"]]},
                    {"table_name":"test_no_default_tp_time", "data": [["dev2", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:11"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:12"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev1", "57.3", "2020-02-02 20:01:05"],
                    ["dev8", "67", "2020-02-02 20:01:05"],
                    ["dev3", "59", "2020-02-02 20:01:05"],
                    ["dev2", "214.3", "2020-02-02 20:01:10"],
                    ["dev8", "77", "2020-02-02 20:01:10"],
                    ["dev3", "57.3", "2020-02-02 20:01:10"]
                    ]}]
        },


        {
            "id": 20,
            "tags": ["tumble window", "timestamp extracted from json"],
            "name": "tumble w/transformed timestamp",
            "description": "extract timestamp from json and run tumble on it",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), window_end from tumble(test, to_datetime(json_extract_string(json, 'create_time')), interval 5 second) group by id, window_end"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1,"data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:06"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:14"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev1", 60, "2021-11-02 20:00:05"],
                    ["dev2", 66, "2021-11-02 20:00:05"],
                    ["dev4", 76, "2021-11-02 20:00:10"],
                    ["dev3", 80, "2021-11-02 20:00:10"],
                    ["dev8", 77, "2021-11-02 20:00:10"]
                    ]}]
        },
        {
            "id": 21,
            "tags": ["hopping window", "timestamp extracted from json"],
            "name": "hop w/transformed timestamp",
            "description": "tranform function in hopping window query",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), window_end from hop(test, to_time(json_extract_string(json, 'create_time')), interval 2 second, interval 5 second) where window_end < '2021-11-02 20:00:09' group by id, window_end"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:06"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:14"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev2", 58.3, "2021-11-02 20:00:03"],
                    ["dev1", 60, "2021-11-02 20:00:03"],
                    ["dev1", 60, "2021-11-02 20:00:05"],
                    ["dev2", 66, "2021-11-02 20:00:05"],
                    ["dev1", 59, "2021-11-02 20:00:07"],
                    ["dev8", 77, "2021-11-02 20:00:07"],
                    ["dev2", 66, "2021-11-02 20:00:07"]
                    ]}]
        },

        {
            "id": 22,
            "tags": ["join"],
            "name": "stream tail join table",
            "description": "stream tail join table",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":1, "query":"select a.id, b.type, a.value from test as a join table(test_d) as b on a.id = b.id"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1,"data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev4", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev5", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev6", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev9", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101","expected_results":
                    [["dev1", "roof", 57.3],
                    ["dev1", "roof", 66],
                    ["dev2", "field", 58.3],
                    ["dev4", "wall", 59],
                    ["dev8", "floor", 67],
                    ["dev8", "floor", 77],
                    ["dev3", "window", 57.3],
                    ["dev5", "roof", 66],
                    ["dev2", "field",76],
                    ["dev6", "window", 80],
                    ["dev8", "floor", 67]
                    ]}]
        },
        {
            "id": 23,
            "tags": ["join"],
            "name": "stream table join table w/o aggregation",
            "description": "stream table join table w/o aggregation",
            "steps":[
                {"inputs": [
                    {"table_name":"test", "wait":1, "data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 70, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"101", "wait":3, "query_type": "table", "query":"select a.id, b.type, a.value from table(test) as a join table(test_d) as b on a.id = b.id where a.value < 70"}]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev1", "roof", 57.3],
                    ["dev2", "field", 58.3]
                    ]}]
        },
        {
            "id": 24,
            "tags": ["join"],
            "name": "stream table join table w/ aggregation",
            "description": "stream table join table w/ aggregation",
            "steps":[
                {"inputs": [
                    {"table_name":"test", "wait":1, "data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev4", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev5", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev6", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev9", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]}
                ]},
                { "statements": [
                    {"client":"python","query_id":"101", "wait":5, "query_type": "table", "query":"select a.id, b.type, max(value) from table(test) as a join table(test_d) as b on a.id = b.id group by a.id, b.type"}]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev1", "roof", 66],
                    ["dev4", "wall", 59],
                    ["dev8", "floor", 77],
                    ["dev3", "window", 57.3],
                    ["dev5", "roof", 66],
                    ["dev2", "field", 76],
                    ["dev6", "window", 80]
                    ]}]
        },
        {
            "id": 25,
            "tags": ["join"],
            "name": "stream table join table w/ aggregation and where",
            "description": "stream table join table w/ aggregation and where",
            "steps":[
                {"inputs": [
                    {"table_name":"test","wait":1, "data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev4", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev5", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev6", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev9", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "table", "wait":10, "query":"select a.id, b.type, max(value) from table(test) as a join table(test_d) as b on a.id = b.id where b.type = 'field' or b.type = 'roof' group by a.id, b.type"}]}
            ],

            "expected_results": [{"query_id":"101","expected_results":
                    [["dev1", "roof", 66],
                    ["dev5", "roof", 66],
                    ["dev2", "field", 76]
                    ]}]
        },
        {
            "id": 26,
            "tags": ["join"],
            "name": "stream global aggregation join table",
            "description": "global stream aggregation join table",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream","query_end_timer":8, "query":"select a.id, b.type, max(value) from test as a join table(test_d) as b on a.id = b.id group by a.id, b.type limit 7 emit periodic 5s"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1,"data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev4", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev5", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev6", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev9", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev1", "roof", 66],
                    ["dev4", "wall", 59],
                    ["dev8", "floor", 77],
                    ["dev3", "window", 57.3],
                    ["dev5", "roof", 66],
                    ["dev2", "field", 76],
                    ["dev6", "window", 80]
                    ]}]
        },
        {
            "id": 27,
            "tags": ["join"],
            "name": "stream global aggregation join table w/where",
            "description": "global stream aggregation join table w/where",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":6, "query":"select a.id, b.type, max(value) from test as a join table(test_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' group by a.id, b.type limit 3 emit periodic 5s"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev4", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev5", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev6", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev9", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]]}
                ]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev1", "roof", 66],
                    ["dev5", "roof", 66],
                    ["dev2", "field", 76]
                    ]}]
        },
        {
            "id": 28,
            "tags": ["join"],
            "name": "stream tumble aggregation join table",
            "description": "stream stream aggregation join",
            "steps":[
                {"statements": [
                    {"client":"python", "query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select a.id, b.type, max(a.value), window_start, window_end from tumble(test, timestamp, interval 5 second) as a join table(test_d) as b on a.id = b.id group by a.id, b.type, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev4", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:06"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:14"],
                    ["dev4", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:15"]]}
                ]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev1", "roof", 57.3, "2020-02-02 20:01:00", "2020-02-02 20:01:05"],
                    ["dev2", "field", 66, "2020-02-02 20:01:00", "2020-02-02 20:01:05"],
                    ["dev2", "field", 58.3, "2020-02-02 20:01:05", "2020-02-02 20:01:10"],
                    ["dev4", "wall", 59, "2020-02-02 20:01:05", "2020-02-02 20:01:10"],
                    ["dev8", "floor", 67, "2020-02-02 20:01:05", "2020-02-02 20:01:10"],
                    ["dev4", "wall", 76, "2020-02-02 20:01:10", "2020-02-02 20:01:15"],
                    ["dev8", "floor", 77, "2020-02-02 20:01:10", "2020-02-02 20:01:15"],
                    ["dev3", "window", 80, "2020-02-02 20:01:10", "2020-02-02 20:01:15"]
                    ]}]
        },
        {
            "id": 29,
            "tags": ["join"],
            "name": "stream tumble aggregation join table w/where",
            "description": "stream stream aggregation join table w/where",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":1, "query":"select a.id, b.type, max(a.value), window_start, window_end from tumble(test, timestamp, interval 5 second) as a join table(test_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall' group by a.id, b.type, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1,"data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test", "data": [["dev4", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:06"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:14"],
                    ["dev4", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev1", "roof", 57.3, "2020-02-02 20:01:00", "2020-02-02 20:01:05"],
                    ["dev2", "field", 66, "2020-02-02 20:01:00", "2020-02-02 20:01:05"],
                    ["dev2", "field", 58.3, "2020-02-02 20:01:05", "2020-02-02 20:01:10"],
                    ["dev4", "wall", 59, "2020-02-02 20:01:05", "2020-02-02 20:01:10"],
                    ["dev4", "wall", 76, "2020-02-02 20:01:10", "2020-02-02 20:01:15"]
                    ]}]
        },
        {
            "id": 30,
            "tags": ["subquery"],
            "name": "tumble aggregation based on vanilla subquery extracts timestamp from json",
            "description": "tranform function in subquery and run tumble on the subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":1, "query":"with transformed as (select id, value, to_datetime(json_extract_string(json, 'create_time')) as tranformed_timestamp from test) select id, max(value), window_start, window_end from tumble(transformed, tranformed_timestamp, interval 5 second) group by id, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1,"data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:06"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:14"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev1", 60, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                    ["dev2", 66, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                    ["dev4", 76, "2021-11-02 20:00:05", "2021-11-02 20:00:10"],
                    ["dev3", 80, "2021-11-02 20:00:05", "2021-11-02 20:00:10"],
                    ["dev8", 77, "2021-11-02 20:00:05", "2021-11-02 20:00:10"]
                    ]}]
        },

        {
            "id": 31,
            "tags": ["subquery"],
            "name": "hopping aggregation based on vanilla subquery extracts timestamp from json",
            "description": "tranform function in subquery to extract timestamp from a json and run hopping on the subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":1, "query":"with transformed as (select id, value, to_datetime(json_extract_string(json, 'create_time')) as tranformed_timestamp from test) select id, max(value), window_start, window_end from hop(transformed, tranformed_timestamp, interval 2 second, interval 5 second) group by id, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:06"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:14"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", 60, "2021-11-02 19:59:58", "2021-11-02 20:00:03"],
                ["dev2", 58.3, "2021-11-02 19:59:58", "2021-11-02 20:00:03"],
                ["dev2", 66, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev1", 60, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev1", 59, "2021-11-02 20:00:02", "2021-11-02 20:00:07"],
                ["dev2", 66, "2021-11-02 20:00:02", "2021-11-02 20:00:07"],
                ["dev8", 77, "2021-11-02 20:00:02", "2021-11-02 20:00:07"],
                ["dev1", 59, "2021-11-02 20:00:04", "2021-11-02 20:00:09"],
                ["dev8", 77, "2021-11-02 20:00:04", "2021-11-02 20:00:09"],
                ["dev3", 66, "2021-11-02 20:00:04", "2021-11-02 20:00:09"],
                ["dev4", 76, "2021-11-02 20:00:04", "2021-11-02 20:00:09"]
                ]}]
        },

        {
            "id": 32,
            "tags": ["subquery"],
            "name": "global aggregation based on vanilla subquery extracts timestamp from json",
            "description": "tranform function in subquery to extract timestamp from a json and run global aggregation on the subquery",
            "steps":[

                {
                "statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":6, "query":"with transformed as (select id, value, to_datetime(json_extract_string(json, 'create_time')) as tranformed_timestamp from test) select id, max(value) from transformed group by id limit 6 emit periodic 5s"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1,"data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:06"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:14"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                [["dev9", 77],
                ["dev2", 66],
                ["dev8", 77],
                ["dev1", 60],
                ["dev4", 76],
                ["dev3", 80]
                ]}]
        },

        {
            "id": 33,
            "tags": ["subquery"],
            "name": "tail based on tumble subquery extracts timestamp from json",
            "description": "tail based on tumble subquery extracts timestamp from json",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":1, "query":"with transformed_a as (select id, avg(value) as value_avg, window_end as avg_time from tumble(test, timestamp, interval 2 second) group by id, window_end) select id, value_avg, avg_time from transformed_a"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1,"data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"],
                    ["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:04"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:07"],
                    ["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:10"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]
                    ]}
                ]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", 63, "2020-02-02 20:01:02"],
                ["dev2", 49, "2020-02-02 20:01:04"],
                ["dev8", 67, "2020-02-02 20:01:06"],
                ["dev8", 77, "2020-02-02 20:01:08"],
                ["dev4", 76, "2020-02-02 20:01:12"],
                ["dev3", 62, "2020-02-02 20:01:12"],
                ["dev3", 80, "2020-02-02 20:01:14"],
                ["dev4", 67, "2020-02-02 20:01:14"]

                ]}]
        },

        {
            "id": 34,
            "tags": ["subquery"],
            "name": "tumble based on tumble subquery",
            "description": "tranform function in subquery to extract timestamp from a json and run tumble aggregation on the subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":1, "query":"with transformed_a as (select id, avg(value) as value_avg, window_end as avg_time from tumble(test, timestamp, interval 2 second) group by id, window_end) select id, max(value_avg), window_end from tumble(transformed_a, avg_time, interval 5 second) group by id, window_end"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:04"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:07"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:10"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", 63, "2020-02-02 20:01:05"],
                ["dev2", 49, "2020-02-02 20:01:05"],
                ["dev8", 77, "2020-02-02 20:01:10"]
                ]}]
        },

        {
            "id": 35,
            "tags": ["subquery"],
            "name": "tumble minK based on tumble subquery",
            "description": "tumble minK based on tumble subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":1, "query":"with transformed_a as (select id, avg(value) as value_avg, window_end as avg_time from tumble(test, timestamp, interval 2 second) group by id, window_end) select id, min_k(value_avg, 1), window_end from tumble(transformed_a, avg_time, interval 5 second) group by id, window_end"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:04"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:07"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:10"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", "[63.0]", "2020-02-02 20:01:05"],
                ["dev2", "[49.0]", "2020-02-02 20:01:05"],
                ["dev8", "[67.0]", "2020-02-02 20:01:10"]
                ]}]
        },

        {
            "id": 36,
            "tags": ["subquery"],
            "name": "hopping avg based on tumble sum subquery",
            "description": "hopping avg based on tumble sum subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":2, "query":"with transformed_a as (select id, sum(value) as value_q, window_end as q_time from tumble(test, timestamp, interval 1 second) group by id, window_end) select id, avg(value_q), window_end from hop(transformed_a, q_time, interval 2 second, interval 5 second) group by id, window_end"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1,"data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", 60, "2021-11-02 20:00:03"],
                ["dev2", 30, "2021-11-02 20:00:05"],
                ["dev1", 63, "2021-11-02 20:00:05"],
                ["dev1", 63, "2021-11-02 20:00:07"],
                ["dev2", 49, "2021-11-02 20:00:07"],
                ["dev8", 67, "2021-11-02 20:00:07"],
                ["dev2", 68, "2021-11-02 20:00:09"],
                ["dev4", 76, "2021-11-02 20:00:09"],
                ["dev8", 72, "2021-11-02 20:00:09"],
                ["dev1", 66, "2021-11-02 20:00:09"]
                ]}]
        },

        {
            "id": 37,
            "tags": ["subquery"],
            "name": "tumble avg based on hopping sum subquery",
            "description": "tumble avg based on hopping sum subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":1, "query":"with transformed_a as (select id, sum(value) as value_s, window_end as s_time from hop(test, timestamp, interval 1 second, interval 5 second) group by id, window_end) select id, avg(value_s), window_end from tumble(transformed_a, s_time, interval 3 second) group by id, window_end"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101", "wait":1,"data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", 60, "2021-11-02 20:00:03"],
                ["dev1", 104, "2021-11-02 20:00:06"],
                ["dev2", 52.67, "2021-11-02 20:00:06"],
                ["dev2", 88, "2021-11-02 20:00:09"],
                ["dev4", 76, "2021-11-02 20:00:09"],
                ["dev8", 118.33, "2021-11-02 20:00:09"],
                ["dev1", 86, "2021-11-02 20:00:09"]
                ]}]
        },

        {
            "id": 38,
            "tags": ["subquery"],
            "name": "tumble avg based on hist subquery",
            "description": "tumble avg based on hist subquery",
            "steps":[
                {"inputs": [
                    {"table_name":"test","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"],
                    ["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"],
                    ["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"101", "wait":5, "query_type": "table", "query_end_timer":5, "query":"with transformed as (select id, value, to_datetime(json_extract_string(json, 'create_time')) as tranformed_timestamp from table(test)) select id, max(value), window_end from tumble(transformed, tranformed_timestamp, interval 5 second) group by id, window_end"}]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", 66, "2021-11-02 20:00:05"],
                ["dev4", 67, "2021-11-02 20:00:05"],
                ["dev2", 68, "2021-11-02 20:00:05"],
                ["dev3", 80, "2021-11-02 20:00:10"],
                ["dev4", 76, "2021-11-02 20:00:10"],
                ["dev8", 77, "2021-11-02 20:00:10"],
                ["dev9", 77, "2021-11-02 20:00:15"]
                ]}]
        },

        {
            "id": 39,
            "tags": ["subquery"],
            "name": "hop count based on table subquery",
            "description": "hop count based on table subquery",
            "steps":[
                {"inputs": [
                    {"table_name":"test","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"],
                    ["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev4", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"],
                    ["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]}
                ]},
                {"statements": [
                    {"client":"python", "wait": 5, "query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"with transformed as (select id, value, to_datetime(json_extract_string(json, 'create_time')) as tranformed_timestamp from table(test)) select id, count(*), window_start, window_end from hop(transformed, tranformed_timestamp, interval 4 second, interval 5 second) group by id, window_start, window_end"}]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [
                ["dev2", 2, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev3", 2, "2021-11-02 20:00:04", "2021-11-02 20:00:09"],
                ["dev4", 2, "2021-11-02 20:00:04", "2021-11-02 20:00:09"],
                ["dev1", 2, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev2", 1, "2021-11-02 20:00:04", "2021-11-02 20:00:09"],
                ["dev3", 2, "2021-11-02 20:00:08", "2021-11-02 20:00:13"]
                ]}]
        },

        {
            "id": 40,
            "tags": ["subquery"],
            "name": "tumble count based on tumble join table subquery",
            "description": "tumble count based on tumble join table subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"with joined_stream as (select a.id, b.type, max(a.value), window_start as joined_w_start, window_end as joined_w_end from tumble(test, timestamp, interval 3 second) as a join table(test_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall' group by a.id, b.type, window_start, window_end) select id, count(*), window_start, window_end from tumble(joined_stream, joined_w_end, interval 5 second) group by id, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", 1, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev2", 1,  "2021-11-02 20:00:00", "2021-11-02 20:00:05"]
                ]}]
        },


        {
            "id": 41,
            "tags": ["subquery"],
            "name": "hop count based on tumble join table subquery",
            "description": "hop count based on tumble join table subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"with joined_stream as (select a.id, b.type, max(a.value), window_start as joined_w_start, window_end as joined_w_end from tumble(test, timestamp, interval 3 second) as a join table(test_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall' group by a.id, b.type, window_start, window_end) select id, count(*), window_start, window_end from hop(joined_stream, joined_w_end, interval 3 second, interval 5 second) group by id, window_start, window_end"}]},
                { "inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1,"data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", 1, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev2", 1,  "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev1", 2, "2021-11-02 20:00:03", "2021-11-02 20:00:08"],
                ["dev2", 2,  "2021-11-02 20:00:03", "2021-11-02 20:00:08"]
                ]}]
        },

        {
            "id": 42,
            "tags": ["subquery"],
            "name": "tumble count based on hop join table subquery",
            "description": "tumble count based on hop join table subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"with joined_stream as (select a.id, b.type, max(a.value), window_start as joined_w_start, window_end as joined_w_end from hop(test, timestamp, interval 3 second, interval 5 second) as a join table(test_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall' group by a.id, b.type, window_start, window_end) select id, count(*), window_start, window_end from tumble(joined_stream, joined_w_end, interval 3 second) group by id, window_start, window_end"}]},
                { "inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", 1, "2021-11-02 20:00:00", "2021-11-02 20:00:03"],
                ["dev1", 1,  "2021-11-02 20:00:03", "2021-11-02 20:00:06"],
                ["dev2", 1, "2021-11-02 20:00:03", "2021-11-02 20:00:06"]
                ]}]
        },


        {
            "id": 43,
            "tags": ["subquery", "issue-336", "bug"],
            "name": "hop count based on hop join table subquery",
            "description": "hop count based on hopping sum subquery",
            "steps":[
                { "statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":10, "query":"with joined_stream as (select a.id, b.type, max(a.value), window_start as joined_w_start, window_end as joined_w_end from hop(test, timestamp, interval 3 second, interval 5 second) as a join table(test_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall' group by a.id, b.type, window_start, window_end) select id, count(*), window_start, window_end from hop(joined_stream, joined_w_end, interval 3 second, interval 5 second) group by id, window_start, window_end emit timeout 5s"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1,"data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev4", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]}
                ]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", 1, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev2", 1,  "2021-11-02 20:00:03", "2021-11-02 20:00:08"],
                ["dev1", 1, "2021-11-02 20:00:03", "2021-11-02 20:00:08"]
                ]}]
        },


        {
            "id": 44,
            "tags": ["subquery", "bug"],
            "name": "global count based on tail join table subquery",
            "description": "global count based on tail join table subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "terminate":"manuel", "query_end_timer":1, "query":"with joined_stream as (select a.id, b.type, a.value, to_datetime(json_extract_string(json, 'create_time')) as tranformed_timestamp from test as a join table(test_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall') select id, count(*) from joined_stream group by id"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test","wait":1, "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test","wait":1, "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test", "wait":1,"data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"102", "query_type": "table", "query":"kill query where query_id='101'"}]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", 2],
                ["dev2", 2],
                ["dev4", 2]
                ]}]
        },

        {
            "id": 45,
            "tags": ["subquery"],
            "name": "tumble count based on tail join table subquery",
            "description": "tumble count based on tail join table subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":1, "query":"with joined_stream as (select a.id, b.type, a.value, a.timestamp, to_datetime(json_extract_string(json, 'create_time')) as transformed_timestamp from test as a join table(test_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall') select id, count(*), window_start, window_end from tumble(joined_stream,transformed_timestamp, 5s) group by id, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", 2, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev2", 2,  "2021-11-02 20:00:00", "2021-11-02 20:00:05"]
                ]}]
        },

        {
            "id": 46,
            "tags": ["subquery"],
            "name": "hop count based on tail join table subquery",
            "description": "hop count based on tail join table subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":1, "query":"with joined_stream as (select a.id, b.type, a.value, a.timestamp, to_datetime(json_extract_string(json, 'create_time')) as transformed_timestamp from test as a join table(test_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall') select id, count(*), window_start, window_end from hop(joined_stream,timestamp, 2s, 5s) group by id, window_start, window_end"}]},
                { "inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", 1, "2021-11-02 19:59:58", "2021-11-02 20:00:03"],
                ["dev2", 1,  "2021-11-02 19:59:58", "2021-11-02 20:00:03"],
                ["dev1", 2, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev2", 2,  "2021-11-02 20:00:00", "2021-11-02 20:00:05"]
                ]}]
        },

        {
            "id": 47,
            "tags": ["view"],
            "name": "tumble sum based on tail join table view",
            "description": "tumble sum based on tail join table view",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":1, "query":"select id, type, sum(value), window_start, window_end from tumble(test_join_v, timestamp, 5s) group by id, type, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", "roof", 126, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev2", "field", 98, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev8", "floor", 144, "2021-11-02 20:00:05", "2021-11-02 20:00:10"],
                ["dev3", "window", 204, "2021-11-02 20:00:05", "2021-11-02 20:00:10"],
                ["dev4", "wall", 143, "2021-11-02 20:00:05", "2021-11-02 20:00:10"]
                ]}]
        },

        {
            "id": 48,
            "tags": ["view"],
            "name": "global sum based on tail join table view",
            "description": "global sum based on tail join table view",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream",  "query_end_timer":7, "query":"select type, count(value) from test_join_v group by type limit 5 emit periodic 5s"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}               
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["roof", 2],
                ["field", 2],
                ["floor", 3],
                ["window", 3],
                ["wall", 2]
                ]}]
        },

        {
            "id": 49,
            "tags": ["settings", "query_mode"],
            "name": "query_mode='table'",
            "description": "query_mode='table'",
            "steps":[
                {"inputs": [
                    {"table_name":"test","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]},
                {"statements": [
                    {"client":"python","wait": 4,"query_id":"101", "query_type": "table", "query_end_timer":1, "query":"select id, avg(value) from test group by id settings query_mode='table'"}]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev2", 49],
                ["dev8", 73.67],
                ["dev1", 63],
                ["dev4", 71.5],
                ["dev3", 68]
                ]}]
        },


        {
            "id": 50,
            "tags": ["settings", "asterisk_include_reserved_columns"],
            "name": "asterisk_include_reserved_columns = false",
            "description": "asterisk_include_reserved_columns = false",
            "steps":[
                {"inputs": [
                    {"table_name":"test","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "table", "wait":1, "query":"select *  from test where id = 'dev1' settings query_mode='table', asterisk_include_reserved_columns=false"}]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"]
                ]}]
        },

        {
            "id": 51,
            "tags": ["seek to"],
            "name": "stream seek to earliest",
            "description": "seek to earliest, no command could clear stream storage so not stable, so use test_seek table created during setup to avoid stream storage impact, will introduce topic clean function in test automation later",
            "steps":[
                {"inputs": [
                    {"table_name":"test","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]},
                {"statements": [
                    {"client":"python","wait": 4,"query_id":"101", "query_type": "stream", "query_end_timer":2, "query":"select id, count(*), window_start, window_end from tumble(test, timestamp, 5s) where id = 'dev1' group by id, window_start, window_end settings seek_to = 'earliest'"}]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", 2, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev1", 1, "2021-11-02 20:00:05", "2021-11-02 20:00:10"]
                ]}]
        },

        {
            "id": 52,
            "tags": ["seek to", "to reproduce", "native_not_support"],
            "name": "stream seek to ago interval",
            "description": "seek to ago interval",
            "steps":[
                {"inputs": [
                    {"table_name":"test","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "sleep": "10", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select id, value from test settings seek_to='-5s'"}]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev2", 68],
                ["dev8", 67],
                ["dev8", 77]
                ]}]
        },

        {
            "id": 53,
            "tags": ["seek to", "bug"],
            "name": "stream seek to specific time",
            "description": "seek to specific time",
            "steps":[
                {"inputs": [
                    {"table_name":"test", "wait":1,"data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                        ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                        ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                        {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                        ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                        ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                        {"table_name":"test", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                        ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                        ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                        {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                        ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                        ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select id, count(*), window_end from tumble(test,timestamp, 5s) group by id, window_end settings seek_to='2021-11-02T20:00:05'"}]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev3", 3, "2021-11-02 20:00:10"],
                ["dev8", 4, "2021-11-02 20:00:10"],
                ["dev4", 2, "2021-11-02 20:00:10"]
                ]}]
        },
        {
            "id": 54,
            "tags": ["snapshot seek to"],
            "name": "snapshot seek to earliest",
            "description": "snapshot seek to earliest",
            "steps":[
                {"inputs": [
                    {"table_name":"test","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"],
                    ["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"],
                    ["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]},
                {"statements": [
                    {"client":"python","wait": 8,"query_id":"101", "query_type": "table", "query":"select id, count(*), window_start, window_end from tumble(test, timestamp, 5s) where id = 'dev1' group by id, window_start, window_end settings seek_to = 'earliest', query_mode = 'table'"}]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev1", 2, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev1", 1, "2021-11-02 20:00:05", "2021-11-02 20:00:10"],
                ["dev1", 1, "2021-11-02 20:00:10", "2021-11-02 20:00:15"]
                ]}]
        },

        {
            "id": 55,
            "tags": ["snapshot seek to"],
            "name": "snapshot seek to ago interval",
            "description": "seek to ago interval",
            "steps":[
                {"inputs": [
                    {"table_name":"test_no_default_tp_time","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"],
                    ["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"101","wait":2, "query_type": "table", "query":"select id, value from test_no_default_tp_time settings seek_to='-30s', query_mode = 'table'"}]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [
                ["dev1", 60.0],
                ["dev1", 66.0],
                ["dev2", 30.0],
                ["dev2", 68],
                ["dev8", 67],
                ["dev8", 77]
                ]}]
        },

        {
            "id": 56,
            "tags": ["snapshot seek to"],
            "name": "snapshot seek to specific time",
            "description": "seek to specific time",
            "steps":[
                {"inputs": [
                    {"table_name":"test", "wait":1,"data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                        ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                        ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"],
                        ["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                        ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                        ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"],
                        ["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                        ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                        ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                        ["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                        ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                        ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "table", "wait":2, "query":"select id, count(*), window_end from tumble(test,timestamp, 5s) group by id, window_end settings seek_to='2021-11-02T20:00:05', query_mode = 'table'"}]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["dev3", 3, "2021-11-02 20:00:10"],
                ["dev8", 2, "2021-11-02 20:00:10"],
                ["dev4", 2, "2021-11-02 20:00:10"],
                ["dev8", 1, "2021-11-02 20:00:15"]
                ]}]
        },
        {
            "id": 57,
            "tags": ["seek to", "order by per block"],
            "name": "stream seek to earliest w/order by per block",
            "description": "seek to earliest, no command could clear stream storage so not stable, so use test_seek table created during setup to avoid stream storage impact, will introduce topic clean function in test automation later",
            "steps":[
                {"inputs": [
                    {"table_name":"test","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev2", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]},
                {"statements": [
                    {"client":"python","wait": 4,"query_id":"101", "query_type": "stream", "query_end_timer":1, "query":"select emit_version() as emit_version, id, count(*) from tumble(test, timestamp, 5s)  group by id, window_end order by emit_version, id settings seek_to = 'earliest'"}]}
            ],

            "expected_results": [{"query_id":"101", "expected_results":
                [["0", "dev1", 2],
                ["0", "dev2", 4],
                ["1", "dev1", 1],
                ["1", "dev8", 1]
                
                ]}]
        },                

        {
            "id": 60,
            "tags": ["materialized view", "global aggregation"],
            "name": "streaming tail from materialized view as global aggregation by sum and group by id w/by 5s periodic",
            "description": "create materialized view as global aggregation by sum and group by id w/by 5s periodic, select id, sum_value from mv",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table", "query":"drop view if exists test_stream_sum_view"},
                    {"client":"python", "query_type": "table", "wait": 1, "query":"create materialized view test_stream_sum_view as select id, sum(value) as sum_value from test group by id emit periodic 5s"},
                    {"client":"python", "query_id":"101", "depends_on_stream":"test_stream_sum_view","wait":5, "query_type": "stream", "terminate":"manual", "query":"select id, sum_value from test_stream_sum_view"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101", "wait":1, "data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"],
                    ["dev2", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"],
                    ["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev3", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"],["dev2", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]
                    ]}
                ]},
                {"statements": [
                    {"client":"python", "wait": 5, "depends":{"query_id":101}, "query_type": "batch", "query":"kill query where query_id = '101'"},
                    {"client":"python", "wait": 1, "query_type": "table", "query_end_timer": 3, "query":"drop view if exists test_stream_sum_view"}
                ]
                }
            ],

            "expected_results": [{"query_id":"101", "expected_results":[
                ["dev2", "273.3"],
                ["dev8", "288"],
                ["dev1", "123.3"],
                ["dev3", "123.3"]]}
            ]
        },
        {
            "id": 81,
            "tags": ["functions", "streaming functions"],
            "name": "neighbor",
            "description": "function neighbor for streaming",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"102", "query_type": "stream","query_end_timer":1, "query":"select value, neighbor(value, -3) as prev_3, neighbor(value, -3, 0) as prev_3_0 from test"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"102","wait":1, "data": [
                        ["dev1", "ca", 1, "2021-11-02 20:00:01", "2020-02-02 20:00:01"]
                        ]},
                    {"table_name":"test", "data": [
                        ["dev2", "ca", 2, "2021-11-02 20:00:10", "2020-02-02 20:01:02"],
                        ["dev2", "ca", 3, "2021-11-02 20:00:10", "2020-02-02 20:00:02"],
                        ["dev2", "ca", 4, "2021-11-02 20:00:10", "2020-02-02 20:01:02"]
                        ]},
                    {"table_name":"test", "data": [
                        ["dev3", "ca", 5, "2021-11-02 20:00:10", "2020-02-02 20:01:03"]
                        ]}
                ]}
            ],
            "expected_results": [
                {"query_id":"102", "expected_results": [
                    [1, 0, 0],
                    [2, 0, 0],
                    [3, 0, 0],
                    [4, 1, 1],
                    [5, 2, 2]
                ]}]
        },
        {
            "id": 82,
            "tags": ["functions", "streaming functions"],
            "name": "lag",
            "description": "function lag",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"102", "query_type": "stream","query_end_timer":1, "query":"select value, lag(value) as prev_1, lag(value, 3, 0) as prev_3_0 from test"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"102","wait":1, "data": [
                        ["dev1", "ca", 1, "2021-11-02 20:00:01", "2020-02-02 20:00:01"]
                        ]},
                    {"table_name":"test", "data": [
                        ["dev2", "ca", 2, "2021-11-02 20:00:10", "2020-02-02 20:01:02"],
                        ["dev2", "ca", 3, "2021-11-02 20:00:10", "2020-02-02 20:00:02"],
                        ["dev2", "ca", 4, "2021-11-02 20:00:10", "2020-02-02 20:01:02"]
                        ]},
                    {"table_name":"test", "data": [
                        ["dev3", "ca", 5, "2021-11-02 20:00:10", "2020-02-02 20:01:03"]
                        ]}
                ]}
            ],
            "expected_results": [
                {"query_id":"102", "expected_results": [
                    [1, 0, 0],
                    [2, 1, 0],
                    [3, 2, 0],
                    [4, 3, 1],
                    [5, 4, 2]
                ]}]
        },
        {
            "id": 83,
            "tags": ["functions", "streaming functions"],
            "name": "lags",
            "description": "function lags",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"102", "query_type": "stream","query_end_timer":1, "query":"select value, lags(value, 1, 3) as prev_1_3, lags(value, 2, 5, -1) as `prev_2_5_-1` from test"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"102","wait":1, "data": [
                        ["dev1", "ca", 1, "2021-11-02 20:00:01", "2020-02-02 20:00:01"]
                        ]},
                    {"table_name":"test", "data": [
                        ["dev2", "ca", 2, "2021-11-02 20:00:10", "2020-02-02 20:01:02"],
                        ["dev2", "ca", 3, "2021-11-02 20:00:10", "2020-02-02 20:00:02"],
                        ["dev2", "ca", 4, "2021-11-02 20:00:10", "2020-02-02 20:01:02"]
                        ]},
                    {"table_name":"test", "data": [
                        ["dev3", "ca", 5, "2021-11-02 20:00:10", "2020-02-02 20:01:03"]
                        ]}
                ]}
            ],
            "expected_results": [
                {"query_id":"102", "expected_results": [
                    [1, "[0.0, 0.0, 0.0]", "[-1.0, -1.0, -1.0, -1.0]"],
                    [2, "[1.0, 0.0, 0.0]", "[-1.0, -1.0, -1.0, -1.0]"],
                    [3, "[2.0, 1.0, 0.0]", "[1.0, -1.0, -1.0, -1.0]"],
                    [4, "[3.0, 2.0, 1.0]", "[2.0, 1.0, -1.0, -1.0]"],
                    [5, "[4.0, 3.0, 2.0]", "[3.0, 2.0, 1.0, -1.0]"]
                ]}]
        },
        {
            "id": 84,
            "tags": ["functions", "streaming functions"],
            "name": "grok",
            "description": "function grok",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"102", "query_type": "stream","query_end_timer":1, "query":"select grok(json, '{\"id\": %{INT:id}, \"type\": %{DATA:type}, \"ipv4\": %{IPV4:ipv4}, \"ipv6\": %{IP:ipv6}, \"uuid\": %{UUID:uuid}%{DATA}') as map, map['id'], map['type'] from test"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"102","wait":1, "data": [
                        ["dev1", "ca", 1, "{\"id\": 1, \"type\": T1, \"ipv4\": 127.0.0.1, \"ipv6\": ::1, \"uuid\": feb540dc-c4e4-4c7e-a975-02f0304364a9}", "2020-02-02 20:00:01"]
                        ]},
                    {"table_name":"test", "data": [
                        ["dev2", "ca", 2, "{\"id\": 2, \"type\": T2, \"ipv4\": 199.101.192.190, \"ipv6\": 1050:0000:0000:0000:0005:0600:300c:326b, \"uuid\": Feb540dc-c4e4-4c7e-a975-02f0304364a9, \"data\": \"abc\"}", "2020-02-02 20:01:02"],
                        ["dev2", "ca", 3, "{\"id\": 3, \"type\": T3, \"ipv4\": 0.0.0.0, \"ipv6\": 1050:0:0:0:5:600:300c:326b, \"uuid\": 0eb540dc-c4e4-4c7e-a975-02f0304364a9, \"data\": \"abc\"}", "2020-02-02 20:00:02"],
                        ["dev2", "ca", 4, "{\"id\": 4, \"data\": \"abc\", \"type\": T4, \"ipv4\": 0.0.0.0, \"ipv6\": 1050:0:0:0:5:600:300c:326b, \"uuid\": feb540dc-C4e4-4c7e-a975-02f0304364a9", "2020-02-02 20:01:02"]
                        ]},
                    {"table_name":"test", "data": [
                        ["dev3", "ca", 5, "{\"id\": 5, \"type\": T5, \"ipv4\": 172.31.255.255, \"ipv6\": ff06::c3, \"uuid\": feb540dc-C4e4-4c7e-a975-02f0304364a9, \"data\": \"abc\"}", "2020-02-02 20:01:03"]
                        ]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"103", "wait": 3, "query_type": "table", "query":"select grok(json, '{\"id\": %{INT:id}, \"type\": %{DATA:type}, \"ipv4\": %{IPV4:ipv4}, \"ipv6\": %{IP:ipv6}, \"uuid\": %{UUID:uuid}%{DATA}') as map, map['id'], map['type'] from table(test)"}]}
            ],
            "expected_results": [
                {"query_id":"102", "expected_results": [
                    ["{'id': '1', 'type': 'T1', 'ipv4': '127.0.0.1', 'ipv6': '::1', 'uuid': 'feb540dc-c4e4-4c7e-a975-02f0304364a9'}", "1", "T1"],
                    ["{'id': '2', 'type': 'T2', 'ipv4': '199.101.192.190', 'ipv6': '1050:0000:0000:0000:0005:0600:300c:326b', 'uuid': 'Feb540dc-c4e4-4c7e-a975-02f0304364a9'}", "2", "T2"],
                    ["{'id': '3', 'type': 'T3', 'ipv4': '0.0.0.0', 'ipv6': '1050:0:0:0:5:600:300c:326b', 'uuid': '0eb540dc-c4e4-4c7e-a975-02f0304364a9'}", "3", "T3"],
                    ["{}", "", ""],
                    ["{'id': '5', 'type': 'T5', 'ipv4': '172.31.255.255', 'ipv6': 'ff06::c3', 'uuid': 'feb540dc-C4e4-4c7e-a975-02f0304364a9'}", "5", "T5"]
                ]},
                {"query_id":"103", "expected_results": [
                    ["{'id': '1', 'type': 'T1', 'ipv4': '127.0.0.1', 'ipv6': '::1', 'uuid': 'feb540dc-c4e4-4c7e-a975-02f0304364a9'}", "1", "T1"],
                    ["{'id': '2', 'type': 'T2', 'ipv4': '199.101.192.190', 'ipv6': '1050:0000:0000:0000:0005:0600:300c:326b', 'uuid': 'Feb540dc-c4e4-4c7e-a975-02f0304364a9'}", "2", "T2"],
                    ["{'id': '3', 'type': 'T3', 'ipv4': '0.0.0.0', 'ipv6': '1050:0:0:0:5:600:300c:326b', 'uuid': '0eb540dc-c4e4-4c7e-a975-02f0304364a9'}", "3", "T3"],
                    ["{}", "", ""],
                    ["{'id': '5', 'type': 'T5', 'ipv4': '172.31.255.255', 'ipv6': 'ff06::c3', 'uuid': 'feb540dc-C4e4-4c7e-a975-02f0304364a9'}", "5", "T5"]
                ]}]
        },
        {
            "id": 90,
            "tags": ["tumble window", "functions", "func rename"],
            "name": "tumble w/funcs: json, to_date, replace_regex, to_time",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), json_extract_bool(json, 'bool') as json_bool, to_date(json_extract_string(json, '1953')) as to_date, replace_regex(json_extract_string(json, '1953'), '11*', 'a') as replace_regex, json_extract_float(json, 'float') as json_float, json_extract_int(json, 'int') as json_extract_int, json_query(json, '$.array[*][0 to 2, 4]') as json_query, json_extract_array_raw(json, 'array') as json_extract_array_raw, json_value(json, '$.array[*][0 to 2, 4]') as json_value, window_end from tumble(test, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, json_bool, json_float, json_extract_int, to_date, replace_regex, json_extract_array_raw, json_value, window_end"}

                ]},

                {"inputs": [
                    {"table_name":"test", "depends_on":"101", "wait":1,"data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int\": 100, \"bool\":true, \"array\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001,\"int\": 100.03, \"bool\":true, \"array\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int\": 312,\"bool\":false, \"array\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int\": 65536.001, \"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":false, \"array\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":false, \"array\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev2", 66, "True", "1953-11-02", "a953-a-02", "127.001", "0", "[1, 1, 4, 0, -1, -4]", "['[1,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","1", "2021-11-02 20:00:05"],
                    ["dev1", 59, "True", "1953-11-02", "a953-a-02", "0", "0", "[0, 1, 4, 0, -1, -4]", "['[0,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","0", "2021-11-02 20:00:05"],
                    ["dev1", 60, "True", "1953-11-02", "a953-a-02", "127.001", "100", "[20, 1, 4, 0, -1, -4]", "['[20,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","20", "2021-11-02 20:00:05"],
                    ["dev2", 58.3, "False", "1953-11-02", "a953-a-02", "127.001", "312", "[22, 1, 4, 0, -1, -4]", "['[22,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","22", "2021-11-02 20:00:05"]
                    ]}]
        },

        {
            "id": 91,
            "tags": ["tumble window", "functions", "func rename", "bug"],
            "name": "tumble w/funcs: json, to_date, replace_regex, to_time",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), json_extract_bool(json, 'bool') as json_bool, to_date(json_extract_string(json, '1953')) as to_date, replace_regex(json_extract_string(json, '1953'), '11*', 'a') as replace_regex, json_extract_float(json, 'float') as json_float, json_extract_int(json, 'int') as json_extract_int, json_query(json, '$.array[*][0 to 2, 4]') as json_query, json_extract_array_raw(json, 'array') as json_extract_array_raw, json_value(json, '$.array[*][0 to 2, 4]') as json_value, window_end from tumble(test, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, json_bool, json_float, json_extract_int, to_date, replace_regex, json_extract_array_raw, json_value, window_end"}

                ]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int\": 231584178474632390847141970017375815706539969331281128078915168015826259279872, \"bool\":true, \"array\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001,\"int\": 100.03, \"bool\":true, \"array\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int\": 65536,\"bool\":false, \"array\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int\": 65536.001, \"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":false, \"array\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":false, \"array\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                [["dev2", 66, "1", "2133-04-08", "a953-a-02", "127.001", "0", "[1, 1, 4, 0, -1, -4]", "['[1,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","1", "2021-11-02 20:00:05"],
                ["dev1", 59, "1", "2133-04-08", "a953-a-02", "0", "0", "[0, 1, 4, 0, -1, -4]", "['[0,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","0", "2021-11-02 20:00:05"],
                ["dev1", 60, "1", "2133-04-08", "a953-a-02", "127.001", "0", "[20, 1, 4, 0, -1, -4]", "['[20,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","20", "2021-11-02 20:00:05"],
                ["dev2", 58.3, "0", "2133-04-08", "a953-a-02", "127.001", "65536", "[22, 1, 4, 0, -1, -4]", "['[22,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","22", "2021-11-02 20:00:05"]
                ]}]
        },

        {
            "id": 92,
            "tags": ["tumble window", "functions", "func rename"],
            "name": "tumble w/funcs: to_int, happy path",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), to_int8(json_extract_string(json, 'int8')) as to_int8, to_int16(json_extract_string(json, 'int16')) as to_int16, to_int(json_extract_string(json, 'int32')) as to_int32, to_int64(json_extract_string(json, 'int64')) as to_int64, to_int128(json_extract_string(json, 'int128')) as to_int128, to_int256(json_extract_string(json, 'int256')) as to_int256, window_end from tumble(test, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, to_int8, to_int16, to_int32, to_int64, to_int128, to_int256, window_end"}

                ]},

                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int8\": -127, \"int16\": -888, \"int32\": -8888, \"int64\": -8888, \"int128\": -88888, \"int256\": -888888, \"bool\":true, \"array\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int8\": \"127\", \"int16\": 888, \"int32\": 8888, \"int64\": 8888, \"int128\": 88888,\"int256\": 888888, \"bool\":true, \"array\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": 888, \"int32\": 8888, \"int64\": 8888, \"int128\": 88888,\"int256\": 888888,\"bool\":false, \"array\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\":6000 , \"int32\":6000 , \"int64\": 6888, \"int128\": 6999, \"int256\": 7999,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":false, \"array\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":false, \"array\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev2", 66, "127","888", "8888", "8888", "88888", "888888", "2021-11-02 20:00:05"],
                    ["dev1", 59, "126","6000", "6000", "6888", "6999", "7999", "2021-11-02 20:00:05"],
                    ["dev1", 60, "-127","-888", "-8888", "-8888", "-88888", "-888888", "2021-11-02 20:00:05"],
                    ["dev2", 58.3, "126", "888", "8888", "8888", "88888", "888888","2021-11-02 20:00:05"]
                    ]}]
        },


        {
            "id": 93,
            "tags": ["tumble window", "functions", "func rename", "bug"],
            "name": "tumble w/funcs: to_int, boundry",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), to_int8(json_extract_string(json, 'int8')) as to_int8, to_int16(json_extract_string(json, 'int16')) as to_int16, to_int32(json_extract_string(json, 'int32')) as to_int32, to_int64(json_extract_string(json, 'int64')) as to_int64, to_int128(json_extract_string(json, 'int128')) as to_int128, to_int256(json_extract_string(json, 'int256')) as to_int256, window_end from tumble(test, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, to_int8, to_int16, to_int32, to_int64, to_int128, to_int256, window_end"}

                ]},

                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int8\": -127, \"int16\": -32767, \"int32\": -2147483647, \"int64\": -9223372036854775807, \"int128\": -170141183460469231731687303715884105727, \"int256\": -7896044618658097711785492504343953926634992332820282019728792003956564819967, \"bool\":true, \"array\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int8\": \"127\", \"int16\": 32767, \"int32\": 2147483647, \"int64\": 9223372036854775807, \"int128\": 170141183460469231731687303715884105727,\"int256\": 7896044618658097711785492504343953926634992332820282019728792003956564819967, \"bool\":true, \"array\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"120\",\"int16\": 5535, \"int32\": 294968295, \"int64\": 223372036854775807, \"int128\": 70141183460469231731687303715884105727,\"int256\": 896044618658097711785492504343953926634992332820282019728792003956564819967,\"bool\":false, \"array\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\":6000 , \"int32\":6000 , \"int64\": 6888, \"int128\": 6999, \"int256\": 7999,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":false, \"array\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":false, \"array\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                [["dev2", 66, "127","32767", "2147483647", "9223372036854775807", "170141183460469231731687303715884105727", "7896044618658097711785492504343953926634992332820282019728792003956564819967", "2021-11-02 20:00:05"],
                ["dev1", 59, "126","6000", "6000", "6888", "6999", "7999", "2021-11-02 20:00:05"],
                ["dev1", 60, "-127","-32767", "--2147483647", "-9223372036854775807", "-170141183460469231731687303715884105727", "-7896044618658097711785492504343953926634992332820282019728792003956564819967", "2021-11-02 20:00:05"],
                ["dev2", 58.3, "120", "5535", "294968295", "223372036854775807", "70141183460469231731687303715884105727", "896044618658097711785492504343953926634992332820282019728792003956564819967","2021-11-02 20:00:05"]
                ]}]
        },


        {
            "id": 94,
            "tags": ["tumble window", "functions", "func rename", "todo"],
            "name": "tumble w/funcs: to_int, out of boundry",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), to_int8(json_extract_string(json, 'int8')) as to_int8, to_int16(json_extract_string(json, 'int16')) as to_int16, to_int32(json_extract_string(json, 'int32')) as to_int32, to_int64(json_extract_string(json, 'int64')) as to_int64, to_int128(json_extract_string(json, 'int128')) as to_int128, to_int256(json_extract_string(json, 'int256')) as to_int256, window_end from tumble(test, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, to_int8, to_int16, to_int32, to_int64, to_int128, to_int256, window_end"}

                ]},

                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int8\": -127, \"int16\": -65535, \"int32\": -4294967295, \"int64\": -18446744073709551615, \"int128\": -340282366920938463463374607431768211455, \"int256\": -115792089237316195423570985008687907853269984665640564039457584007913129639935, \"bool\":true, \"array\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int8\": \"127\", \"int16\": 65535, \"int32\": 4294967295, \"int64\": 18446744073709551615, \"int128\": 340282366920938463463374607431768211455,\"int256\": 115792089237316195423570985008687907853269984665640564039457584007913129639935, \"bool\":true, \"array\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"312\",\"int16\": 75535, \"int32\": 4294968295, \"int64\": 18446744073719551615, \"int128\": 340282366920938463463374607431778211455,\"int256\": 115792089237316195423570985008687907853269984665640564039457584008913129639935,\"bool\":false, \"array\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\":6000 , \"int32\":4194968295 , \"int64\": 16446744073719551615, \"int128\": 330282366920938463463374607431768211455, \"int256\": 105792089237316195423570985008687907853269984665640564039457584007913129639935,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":false, \"array\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":false, \"array\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev2", 66, "127", "2021-11-02 20:00:05"],
                    ["dev1", 59, "126", "2021-11-02 20:00:05"],
                    ["dev1", 60, "-127", "2021-11-02 20:00:05"],
                    ["dev2", 58.3, "56", "2021-11-02 20:00:05"]
                    ]}]
        },

        {
            "id": 100,
            "tags": ["tumble window", "functions", "func rename"],
            "name": "tumble w/funcs: to_decimal, happy path",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), to_decimal(json_extract_string(json, 'decimal32'), 5) as to_decimal32, to_decimal64(json_extract_string(json, 'decimal64'), 10) as to_decimal64, to_decimal128(json_extract_string(json, 'decimal128'), 20) as to_decimal128, to_decimal256(json_extract_string(json, 'decimal256'),30) as to_decimal256, window_end from tumble(test, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, to_decimal32, to_decimal64, to_decimal128, to_decimal256, window_end"}

                ]},

                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"decimal32\": \"-9.99999999999999999999999999999999999999999999999\", \"decimal64\": -0.99999999999999999999999999999999999999999999999, \"decimal128\": -9.99999999999999999999999999999999999999999999999, \"decimal256\": -9.99999999999999999999999999999999999999999999999, \"bool\":true, \"array\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001, \"decimal32\": 0.99999999999999999999999999999999999999999999999, \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999, \"bool\":true, \"array\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":false, \"array\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":true, \"array\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":false, \"array\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":true, \"array\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":false, \"array\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":true, \"array\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":true, \"array\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev2", 66, "1", "0.9999999999", "1", "1", "2021-11-02 20:00:05"],
                    ["dev1", 59, "0.99999","1","1","0.999999999999999999999999999999", "2021-11-02 20:00:05"],
                    ["dev1", 60, "-9.99999", "-1","-10","-10", "2021-11-02 20:00:05"],
                    ["dev2", 58.3, "0.99999", "1", "0.99999999999999999999","1", "2021-11-02 20:00:05"]
                    ]}]
        },

        {
            "id": 101,
            "tags": ["tumble window", "functions", "func rename", "todo"],
            "name": "tumble w/funcs: to_decimal, boundry",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), to_decimal32(json_extract_string(json, 'decimal32'), 8) as to_decimal32, to_decimal64(json_extract_string(json, 'decimal64'), 17) as to_decimal64, to_decimal128(json_extract_string(json, 'decimal128'), 37) as to_decimal128, to_decimal256(json_extract_string(json, 'decimal256'),75) as to_decimal256, window_end from tumble(test, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, to_decimal32, to_decimal64, to_decimal128, to_decimal256, window_end"}

                ]},

                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"decimal32\": \"-9.99999999999999999999999999999999999999999999999\", \"decimal64\": \"-9.99999999999999999999999999999999999999999999999\", \"decimal128\": \"-9.99999999999999999999999999999999999999999999999\", \"decimal256\": \"-9.99999999999999999999999999999999999999999999999\", \"bool\":true, \"array\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\", \"bool\":true, \"array\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":false, \"array\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.9999999999999999999999999999999999999999999999\"9, \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":false, \"array\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":false, \"array\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev2", 66, "127", "2021-11-02 20:00:05"],
                    ["dev1", 59, "126", "2021-11-02 20:00:05"],
                    ["dev1", 60, "-127", "2021-11-02 20:00:05"],
                    ["dev2", 58.3, "56", "2021-11-02 20:00:05"]
                    ]}]
        },
        {
            "id": 102,
            "tags": ["tumble window", "functions", "func rename"],
            "name": "tumble w/funcs: array, happy path)",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), json_extract_array_raw(json, 'array1') as array1, json_extract_array_raw(json, 'array1') as array2 , array_concat(array1, array2) as array_concat, length(array_concat) as array_length, window_end from tumble(test, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, array1, array2, array_concat, array_length, window_end"}

                ]},

                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int\": 100, \"bool\":true, \"array1\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001,\"int\": 100.03, \"bool\":true, \"array1\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int\": 312,\"bool\":false, \"array1\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int\": 65536.001, \"bool\":true, \"array1\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array1\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":false, \"array1\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array1\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array1\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":false, \"array1\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array1\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array1\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array1\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [
                    ["dev1", 59, "['[0,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[0,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[0,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]', '[0,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "4", "2021-11-02 20:00:05"],
                    ["dev2", 66, "['[1,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[1,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[1,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]', '[1,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "4", "2021-11-02 20:00:05"],
                    ["dev1", 60, "['[20,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[20,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[20,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]', '[20,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "4", "2021-11-02 20:00:05"],
                    ["dev2", 58.3, "['[22,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[22,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[22,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]', '[22,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "4", "2021-11-02 20:00:05"]
                    ]}]
        },
        
        
        
        
        {
            "id": 887,
            "tags": ["subquery", "bug"],
            "name": "tumble on top of subquery stream see_to = 'earliest'",
            "description": "tranform function in subquery and run tumble on the subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":1, "query":"with transformed as (select id, value, to_datetime(json_extract_string(json, 'create_time')) as tranformed_timestamp from test settings seek_to='earliest') select id, max(value), window_start, window_end from tumble(transformed, tranformed_timestamp, interval 5 second) group by id, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test", "depends_on":"101","wait":1,"data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:06"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:14"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev1", 60, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                    ["dev2", 66, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                    ["dev4", 76, "2021-11-02 20:00:05", "2021-11-02 20:00:10"],
                    ["dev3", 80, "2021-11-02 20:00:05", "2021-11-02 20:00:10"],
                    ["dev8", 77, "2021-11-02 20:00:05", "2021-11-02 20:00:10"]
                    ]}]
        },        
        {
            "id": 888,
            "tags": ["hopping window", "timestamp extracted from json", "bug"],
            "name": "hop w/transformed timestamp",
            "description": "tranform function in subquery and run tumble on the subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"101", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), window_end from hop(test, to_datetime64(_tp_append_time, 3, 'UTC'), interval 2 second, interval 5 second) where window_end < '2021-11-02 20:00:09' group by id, window_end"}]},
                {"inputs": [
                    {"table_name":"test","depends_on":"101","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test", "data": [["dev1", "ca", 59, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:06"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:14"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"101", "expected_results":
                    [["dev2", 58.3, "2021-11-02 20:00:03"],
                    ["dev1", 60, "2021-11-02 20:00:03"],
                    ["dev1", 60, "2021-11-02 20:00:05"],
                    ["dev2", 66, "2021-11-02 20:00:05"],
                    ["dev1", 59, "2021-11-02 20:00:07"],
                    ["dev8", 77, "2021-11-02 20:00:07"],
                    ["dev2", 66, "2021-11-02 20:00:07"]
                    ]}]
        },

        {
            "id": 889,
            "tags": ["input", "sample"],
            "name": "inputs sample",
            "description": "ingest data into test w/full columes and values",
            "steps":[
                {"statements": [
                    {"client":"python","query_type": "input", "query":"truncate stream test"},
                    {"client":"python","query_id":"101", "query_type": "input", "query":"insert into test (id, location, value, json, timestamp) values ('dev1', 'ca', 370, 'jsonstring', '1999-01-01 11:11:11')"},
                    {"client":"python","query_id":"102", "query_type": "input", "query":"insert into test (id, location, value, json, timestamp) values ('dev2', 'ca', 380, 'jsonstring', '1999-01-01 11:11:11')"}

                    ]},
                {"statements": [
                    {"client":"python","query_id":"103", "wait": 5, "query_type": "table", "query_end_timer":5, "query":"select id, location, value,json, timestamp from table(test)"}]}

                ],
            "expected_results": [{"query_id":"103", "expected_results":
                    [["dev1", "ca", 370, "jsonstring", "1999-01-01 11:11:11"],
                    ["dev2", "ca", 380, "jsonstring", "1999-01-01 11:11:11"]
                    ]}]
        }



    ]
}
