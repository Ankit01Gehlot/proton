DROP STREAM IF EXISTS tab_00610;
DROP STREAM IF EXISTS mv_00610;

create stream tab_00610(d date, x uint32) ENGINE MergeTree(d, x, 8192);
CREATE MATERIALIZED VIEW mv_00610(d date, y uint64) ENGINE MergeTree(d, y, 8192) AS SELECT d, x + 1 AS y FROM tab_00610;

INSERT INTO tab_00610 VALUES ('2018-01-01', 1), ('2018-01-01', 2), ('2018-02-01', 3);

SELECT '-- Before DROP PARTITION --';
SELECT * FROM mv_00610 ORDER BY y;

ALTER STREAM mv_00610 DROP PARTITION 201801;

SELECT '-- After DROP PARTITION --';
SELECT * FROM mv_00610 ORDER BY y;

DROP STREAM tab_00610;
DROP STREAM mv_00610;
