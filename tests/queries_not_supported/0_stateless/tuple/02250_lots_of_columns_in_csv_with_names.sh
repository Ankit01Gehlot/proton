#!/usr/bin/env bash

CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
# shellcheck source=../shell_config.sh
. "$CURDIR"/../shell_config.sh

$CLICKHOUSE_CLIENT -q "DROP STREAM IF EXISTS test_02250"

$CLICKHOUSE_CLIENT -q "CREATE STREAM test_02250
(
    field_1 int32,
    field_2 int32,
    field_3 int32,
    field_4 int32,
    field_5 int32,
    field_6 int32,
    field_7 int32,
    field_8 int32,
    field_9 int32,
    field_10 int32,
    field_11 int32,
    field_12 int32,
    field_13 int32,
    field_14 int32,
    field_15 int32,
    field_16 int32,
    field_17 int32,
    field_18 int32,
    field_19 int32,
    field_20 int32,
    field_21 int32,
    field_22 int32,
    field_23 int32,
    field_24 int32,
    field_25 int32,
    field_26 int32,
    field_27 int32,
    field_28 int32,
    field_29 int32,
    field_30 int32,
    field_31 int32,
    field_32 int32,
    field_33 int32,
    field_34 int32,
    field_35 int32,
    field_36 int32,
    field_37 int32,
    field_38 int32,
    field_39 int32,
    field_40 int32,
    field_41 int32,
    field_42 int32,
    field_43 int32,
    field_44 int32,
    field_45 int32,
    field_46 int32,
    field_47 int32,
    field_48 int32,
    field_49 int32,
    field_50 int32,
    field_51 int32,
    field_52 int32,
    field_53 int32,
    field_54 int32,
    field_55 int32,
    field_56 int32,
    field_57 int32,
    field_58 int32,
    field_59 int32,
    field_60 int32,
    field_61 int32,
    field_62 int32,
    field_63 int32,
    field_64 int32,
    field_65 int32,
    field_66 int32,
    field_67 int32,
    field_68 int32,
    field_69 int32,
    field_70 int32,
    field_71 int32,
    field_72 int32,
    field_73 int32,
    field_74 int32,
    field_75 int32,
    field_76 int32,
    field_77 int32,
    field_78 int32,
    field_79 int32,
    field_80 int32,
    field_81 int32,
    field_82 int32,
    field_83 int32,
    field_84 int32,
    field_85 int32,
    field_86 int32,
    field_87 int32,
    field_88 int32,
    field_89 int32,
    field_90 int32,
    field_91 int32,
    field_92 int32,
    field_93 int32,
    field_94 int32,
    field_95 int32,
    field_96 int32,
    field_97 int32,
    field_98 int32,
    field_99 int32,
    field_100 int32,
    field_101 int32,
    field_102 int32,
    field_103 int32,
    field_104 int32,
    field_105 int32,
    field_106 int32,
    field_107 int32,
    field_108 int32,
    field_109 int32,
    field_110 int32,
    field_111 int32,
    field_112 int32,
    field_113 int32,
    field_114 int32,
    field_115 int32,
    field_116 int32,
    field_117 int32,
    field_118 int32,
    field_119 int32,
    field_120 int32,
    field_121 int32,
    field_122 int32,
    field_123 int32,
    field_124 int32,
    field_125 int32,
    field_126 int32,
    field_127 int32,
    field_128 int32,
    field_129 int32,
    field_130 int32,
    field_131 int32,
    field_132 int32,
    field_133 int32,
    field_134 int32,
    field_135 int32,
    field_136 int32,
    field_137 int32,
    field_138 int32,
    field_139 int32,
    field_140 int32,
    field_141 int32,
    field_142 int32,
    field_143 int32,
    field_144 int32,
    field_145 int32,
    field_146 int32,
    field_147 int32,
    field_148 int32,
    field_149 int32,
    field_150 int32,
    field_151 int32,
    field_152 int32,
    field_153 int32,
    field_154 int32,
    field_155 int32,
    field_156 int32,
    field_157 int32,
    field_158 int32,
    field_159 int32,
    field_160 int32,
    field_161 int32,
    field_162 int32,
    field_163 int32,
    field_164 int32,
    field_165 int32,
    field_166 int32,
    field_167 int32,
    field_168 int32,
    field_169 int32,
    field_170 int32,
    field_171 int32,
    field_172 int32,
    field_173 int32,
    field_174 int32,
    field_175 int32,
    field_176 int32,
    field_177 int32,
    field_178 int32,
    field_179 int32,
    field_180 int32,
    field_181 int32,
    field_182 int32,
    field_183 int32,
    field_184 int32,
    field_185 int32,
    field_186 int32,
    field_187 int32,
    field_188 int32,
    field_189 int32,
    field_190 int32,
    field_191 int32,
    field_192 int32,
    field_193 int32,
    field_194 int32,
    field_195 int32,
    field_196 int32,
    field_197 int32,
    field_198 int32,
    field_199 int32,
    field_200 int32,
    field_201 int32,
    field_202 int32,
    field_203 int32,
    field_204 int32,
    field_205 int32,
    field_206 int32,
    field_207 int32,
    field_208 int32,
    field_209 int32,
    field_210 int32,
    field_211 int32,
    field_212 int32,
    field_213 int32,
    field_214 int32,
    field_215 int32,
    field_216 int32,
    field_217 int32,
    field_218 int32,
    field_219 int32,
    field_220 int32,
    field_221 int32,
    field_222 int32,
    field_223 int32,
    field_224 int32,
    field_225 int32,
    field_226 int32,
    field_227 int32,
    field_228 int32,
    field_229 int32,
    field_230 int32,
    field_231 int32,
    field_232 int32,
    field_233 int32,
    field_234 int32,
    field_235 int32,
    field_236 int32,
    field_237 int32,
    field_238 int32,
    field_239 int32,
    field_240 int32,
    field_241 int32,
    field_242 int32,
    field_243 int32,
    field_244 int32,
    field_245 int32,
    field_246 int32,
    field_247 int32,
    field_248 int32,
    field_249 int32,
    field_250 int32,
    field_251 int32,
    field_252 int32,
    field_253 int32,
    field_254 int32,
    field_255 int32,
    field_256 int32,
    field_257 int32
)
ENGINE = MergeTree
ORDER BY tuple()"

echo -e "field_1\n42" | $CLICKHOUSE_CLIENT -q "INSERT INTO test_02250 FORMAT CSVWithNames" --input_format_with_names_use_header 1
$CLICKHOUSE_CLIENT -q "SELECT * FROM test_02250" 
$CLICKHOUSE_CLIENT -q "DROP STREAM test_02250"
